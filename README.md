# eBPF多维度分析
## 一、简介

​	**eBPF（扩展伯克利数据包过滤器）** 是一项革命性技术，允许在内核态执行用户定义的程序。这些程序可以在内核中安全高效地运行，而无需更改内核源代码，从而实现了对系统行为的深度观察和实时调整。eBPF在网络、安全、监控、性能调优等领域有着广泛的应用。通过eBPF实现高效的数据包过滤和流量分析，优化网络性能。例如，Cilium利用eBPF技术提供可伸缩的网络和安全性，特别适用于Kubernetes和其他云原生环境。通过内核态的性能数据收集和分析，发现系统瓶颈并进行优化。eBPF可以用于捕捉各种性能指标，如CPU使用率、内存使用情况等，从而提供深度的性能分析。eBPF可以无缝地插入内核代码路径，提供详细的性能监测功能。它能够实时收集详细的性能数据，帮助系统管理员和开发者识别并解决性能瓶颈。eBPF可以用于监测容器的资源使用情况，包括CPU、内存、网络等方面的数据。通过与Prometheus等监控工具集成，eBPF可以提供精细的容器监控数据，帮助运维人员更好地管理和优化容器化应用。

​	尽管eBPF在网络、安全、监控、性能调优等领域展现了巨大的潜力和广泛的应用，但目前业界对eBPF本身的性能分析和优化研究仍然不足。因此，本次研究的目的在于通过系统化的性能评估和对比分析，深入探索eBPF在不同使用场景下的表现，特别是对比在不同负载的情境下eBPF中不同类型的map、不同挂载点的性能差异、不同内核版本的使用差异。通过编写和运行各种测试程序，我们将全面分析eBPF在实际操作中的效率和性能瓶颈。最终，基于这些数据，提出针对不同应用场景的最佳实践指导，帮助开发者和运维人员更高效地利用eBPF技术，从而推动eBPF在业界的深入应用和发展。

## 二、测试目的

​	我的研究旨在通过系统化的性能评估和对比分析，全面评估和优化eBPF（扩展伯克利数据包过滤器）的性能。具体而言，我们希望深入探索eBPF在各种使用场景下的性能表现，包括比较不同类型的映射（map）、分析不同挂载点的性能差异，以及评估不同内核版本的影响。通过编写和执行一系列测试程序，我们的目标是深入了解eBPF的操作效率，并识别潜在的性能瓶颈。最终，我们将根据研究结果提出针对特定应用场景的最佳实践指南，推动eBPF技术在各行业的应用和发展。

## 三、测试方案：
[理论分析.md](./docs/Map理论分析.md)

[测试方案.md](./docs/eBPF性能测试方案.md)

## 四、工具使用说明：

### 1.环境准备：

1.1ebpf运行环境：

```shell
#在eBPF_Performance_Analysis/目录下执行指令：
make deps
```

1.2python环境：

```shell
#下载python3
sudo apt install python3
#检查是否下载成功：
python3 --version
#下载pandas库
sudo pip3 install pandas -i https://pypi.tuna.tsinghua.edu.cn/simple
#下载matplotlib库
pip3 install matplotlib
```

2.运行：

```shell
#在eBPF_Performance_Analysis/目录下运行shell脚本：
#此脚本用来比较不同Map类型在时间层面进行增删改查操作的差异
sudo bash run_ebpf_and_process.sh
```
3.结果：

```shell
#运行结束后，程序会生成python工具分析后的图像文件
```


